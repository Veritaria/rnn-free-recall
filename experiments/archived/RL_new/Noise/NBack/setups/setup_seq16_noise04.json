{
    "run_num": 50,
    "model": {
        "class": "ValueMemoryGRUOld",
        "hidden_dim": 128,
        "input_dim": 103,
        "output_dim": 51,
        "use_memory": true,
        "softmax_beta": 1.0,
        "evolve_state_between_phases": true,
        "init_state_type": "noise",
        "flush_noise": 0.4,
        "em_gate_type": "scalar_sigmoid",
        "two_output": true,
        "subclasses": [
            {
                "name": "memory_module",
                "class": "ValueMemory",
                "value_dim": 128,
                "capacity": 16,
                "recall_method": "weight_sum",
                "subclasses": [
                    {
                        "name": "similarity_measure",
                        "class": "BasicSimilarity",
                        "process_similarity": "softmax",
                        "softmax_temperature": 0.1
                    }
                ]
            }
        ]
    },
    "training": [
        {
            "env": [{
                "class": "FreeRecall",
                "vocabulary_num": 50,
                "memory_num": 16,
                "return_action": true,
                "return_reward": true,
                "reset_state_before_test": true
            }],
            "trainer": {
                "num_iter": 5000,
                "test_iter": 1000,
                "save_iter": 2000,
                "stop_test_accu": 0.99,
                "use_memory": true,
                "criterion": {
                    "class": "EncodingCrossEntropyLoss",
                    "class_num": 51
                },
                "sl_criterion": {
                    "class": "EncodingNBackCrossEntropyLoss",
                    "class_num": 51,
                    "nback": 1
                },
                "optimizer": {
                    "class": "Adam",
                    "lr": 0.0002,
                    "weight_decay": 2e-05,
                    "lr_decay_factor": 0.5,
                    "lr_decay_patience": 10,
                    "lr_decay_threshold": 0.001,
                    "min_lr": 1e-07
                }
            }
        },
        {
            "env": [{
                "class": "FreeRecall",
                "vocabulary_num": 50,
                "memory_num": 16,
                "return_action": true,
                "return_reward": true,
                "reset_state_before_test": true,
                "false_reward": -1.0,
                "repeat_penalty": -1.0,
                "not_know_reward": -1.0
            }],
            "trainer": {
                "training_function": "train_model",
                "num_iter": 200000,
                "test_iter": 1000,
                "save_iter": 2000,
                "use_memory": true,
                "stop_test_accu": 0.99,
                "memory_entropy_reg": true,
                "memory_reg_weight": 0.1,
                "criterion": {
                    "class": "A2CLoss",
                    "use_V": true,
                    "eta": 0.01,
                    "gamma": 0.9
                },
                "sl_criterion": {
                    "class": "EncodingNBackCrossEntropyLoss",
                    "class_num": 51,
                    "nback": 1
                },
                "optimizer": {
                    "class": "Adam",
                    "lr": 0.0005,
                    "lr_decay_factor": 0.1,
                    "lr_decay_patience": 30,
                    "lr_decay_threshold": 0.001,
                    "min_lr": 1e-07
                }
            }
        }
    ],
    "load_saved_model": false,
    "context_num": 1000
}