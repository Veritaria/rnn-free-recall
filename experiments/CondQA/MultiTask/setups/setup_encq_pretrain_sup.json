{
    "run_num": 3,
    "model": {
        "class": "DeepValueMemoryGRU",
        "hidden_dim": 128,
        "input_dim": 27,
        "output_dims": [18, 3],
        "use_memory": true,
        "softmax_beta": 1.0,
        "evolve_state_between_phases": true,
        "em_gate_type": "scalar_sigmoid",
        "subclasses": [{
            "name": "memory_module",
            "class": "ValueMemory",
            "value_dim": 128,
            "capacity": 4,
            "recall_method": "weight_sum",
            "subclasses": [
                {
                    "name":"similarity_measure",
                    "class": "BasicSimilarity",
                    "process_similarity": "softmax",
                    "softmax_temperature": 0.1
                }
            ]
        }]
    },
    "training": [{
        "env": [{
            "class": "ConditionalEMRecall",
            "wrapper": "MetaLearningEnv",
            "num_features": 4,
            "feature_dim": 2,
            "sequence_len": 8,
            "reset_state_before_test": true,
            "no_early_stop": true
        }],
        "trainer": {
            "num_iter": 100,
            "test": false,
            "test_iter": 1000,
            "save_iter": 2000,
            "stop_test_accu": 1.01,
            "use_memory": true,
            "criterion": {
                "class": "MultiSupervisedLoss",
                "criteria": [
                    {
                        "class": "EncodingCrossEntropyLoss",
                        "class_num": 18,
                        "no_action_weight": 0.5
                    }
                ]
            },
            "optimizer": {
                "class": "Adam",
                "lr": 5e-4,
                "weight_decay": 2e-5,
                "lr_decay_factor": 0.5,
                "lr_decay_patience": 10,
                "lr_decay_threshold": 1e-3,
                "min_lr": 1e-7
            }
        }
    }, {
        "env": [{
            "class": "ConditionalEMRecall",
            "wrapper": "MetaLearningEnv",
            "num_features": 4,
            "feature_dim": 2,
            "sequence_len": 8,
            "reset_state_before_test": true,
            "include_question_during_encode": true,
            "no_early_stop": true
        }],
        "trainer": {
            "num_iter": 100,
            "test": false,
            "test_iter": 1000,
            "save_iter": 2000,
            "stop_test_accu": 0.99,
            "use_memory": true,
            "criterion": {
                "class": "MultiSupervisedLoss",
                "criteria": [
                    {
                        "class": "EncodingCrossEntropyLoss",
                        "class_num": 18,
                        "no_action_weight": 0.5
                    }
                ]
            },
            "optimizer": {
                "class": "Adam",
                "lr": 5e-4,
                "weight_decay": 2e-5,
                "lr_decay_factor": 0.5,
                "lr_decay_patience": 10,
                "lr_decay_threshold": 1e-3,
                "min_lr": 1e-7
            }
        }
    }, {
        "env": [{
            "class": "ConditionalEMRecall",
            "wrapper": "MetaLearningEnv",
            "num_features": 4,
            "feature_dim": 2,
            "sequence_len": 8,
            "reset_state_before_test": true,
            "correct_reward": 2.5,
            "no_action_reward": -0.0,
            "wrong_reward": -0.75,
            "include_question_during_encode": true
        }],
        "trainer": {
            "training_function": "train_model",
            "num_iter": 100,
            "test": false,
            "test_iter": 1000,
            "save_iter": 2000,
            "use_memory": true,
            "stop_test_accu": 0.99,
            "memory_entropy_reg": true,
            "memory_reg_weight": 0.1,
            "criterion": {
                "class": "MultiRLLoss",
                "criteria": [
                    {
                        "class": "A2CLoss",
                        "use_V": true,
                        "eta": 0.02,
                        "gamma": 0.9
                    }
                ]
            },
            "optimizer": {
                "class": "Adam",
                "lr": 5e-4,
                "lr_decay_factor": 0.1,
                "lr_decay_patience": 30,
                "lr_decay_threshold": 1e-3,
                "min_lr": 1e-7
            }
        }
    }, {
        "env": [{
            "class": "ConditionalQuestionAnswer",
            "wrapper": "MetaLearningEnv",
            "num_features": 4,
            "feature_dim": 2,
            "sequence_len": 4,
            "reset_state_before_test": true,
            "correct_reward": 1.0,
            "no_action_reward": -0.0,
            "wrong_reward": -1.0,
            "include_question_during_encode": true,
            "no_early_stop": true
        }],
        "trainer": {
            "num_iter": 100,
            "test": false,
            "test_iter": 1000,
            "save_iter": 20000,
            "stop_test_accu": 0.98,
            "use_memory": true,
            "phase": "last",
            "used_output_index": [1],
            "criterion": {
                "class": "MultiSupervisedLoss",
                "criteria": [
                    {
                        "class": "EncodingCrossEntropyLoss",
                        "class_num": 3
                    }
                ]
            },
            "optimizer": {
                "class": "Adam",
                "lr": 1e-4,
                "weight_decay": 1e-5,
                "lr_decay_factor": 0.1,
                "lr_decay_patience": 5,
                "lr_decay_threshold": 1e-4,
                "min_lr": 1e-7
            }
        }
    }],
    "load_saved_model": false,
    "context_num": 1000
}